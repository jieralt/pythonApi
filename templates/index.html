<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>任务树</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        body {
            padding: 20px;
        }
        .task-item {
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>任务树</h2>
        <div id="taskTree" class="mb-4">
            <!-- 任务树将在这里生成 -->
        </div>
        <button class="btn btn-primary" onclick="addTask()">添加任务</button>
    </div>

    <script>
        let taskIdCounter = 0;

        function createTaskElement(taskId, taskContent = '') {
            const taskElement = document.createElement('div');
            taskElement.className = 'task-item';
            taskElement.id = `task-${taskId}`;

            const taskInput = document.createElement('input');
            taskInput.type = 'text';
            taskInput.value = taskContent;
            taskInput.className = 'form-control d-inline-block';
            taskInput.style.width = '70%';

            const addButton = document.createElement('button');
            addButton.className = 'btn btn-success btn-sm ml-2';
            addButton.textContent = '添加子任务';
            addButton.onclick = () => addSubTask(taskId);

            const deleteButton = document.createElement('button');
            deleteButton.className = 'btn btn-danger btn-sm ml-2';
            deleteButton.textContent = '删除';
            deleteButton.onclick = () => deleteTask(taskId);

            taskElement.appendChild(taskInput);
            taskElement.appendChild(addButton);
            taskElement.appendChild(deleteButton);

            const subTaskContainer = document.createElement('div');
            subTaskContainer.className = 'ml-4';
            subTaskContainer.id = `subtasks-${taskId}`;

            taskElement.appendChild(subTaskContainer);

            return taskElement;
        }

        function addTask() {
            const taskId = taskIdCounter++;
            const taskTree = document.getElementById('taskTree');
            const taskElement = createTaskElement(taskId);
            taskTree.appendChild(taskElement);
        }

        function addSubTask(parentTaskId) {
            const taskId = taskIdCounter++;
            const subTaskContainer = document.getElementById(`subtasks-${parentTaskId}`);
            const taskElement = createTaskElement(taskId);
            subTaskContainer.appendChild(taskElement);
        }

        function deleteTask(taskId) {
            const taskElement = document.getElementById(`task-${taskId}`);
            taskElement.remove();
        }
    </script>
</body>
</html>
